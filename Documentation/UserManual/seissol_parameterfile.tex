
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%% PARAMETER FILE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt,twoside]{article}

\usepackage{times}
\usepackage{array}
\usepackage{longtable}
\usepackage{epsfig}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{psfrag}
\usepackage{graphicx}
\usepackage{float}
\usepackage{hyperref}
\usepackage{color}
\usepackage{epstopdf}
\usepackage{arydshln}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{textcomp}     % access \textquotesingle
\lstset{basicstyle=\ttfamily\footnotesize,breaklines=true,
  moredelim=**[is][\color{green}]{@}{@},}
\usepackage{ulem}
\hypersetup{
    colorlinks,%
    citecolor=black,%
    filecolor=black,%
    linkcolor=black,%
    urlcolor=blue
}
\def\Q{{\mathcal Q}}
\def\O{{\mathcal O}}
\def\T{{\mathcal T}}
\def\H{{\mathcal H}}
\newcommand{\D}{\displaystyle}
\definecolor{gray}{gray}{0.5}
\newcommand{\seissol}{SeisSol }

\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% COVER PAGE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}

\thispagestyle{empty}
\begin{center}
{\bf{\Huge SeisSol }}\\
\vspace{0,5cm}
{\bf{\Large The ADER-DG Method for \\
\vspace{0,2cm}
           Seismic Wave Propagation}} \\
\vspace{4,0cm}
{\LARGE{\sc User Manual - Parameter files}}\\
\vspace{4,0cm}
{\Large Amaryillis Nerger, Christian Pelties \& Johannes Klicpera\\}
%{\large Last update: \today \\}
\vspace{2,5cm}
{\Large{\sc Geophysics\\
Department of Earth and Environment\\
Ludwig-Maximilians-Universit\"at M\"unchen\\}}
\end{center}

\end{titlepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PAGE LAYOUT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addtolength{\topmargin}{-0.5cm}
\textheight22cm
\evensidemargin7.0mm
\oddsidemargin15.0mm
\pagestyle{headings}
\pagenumbering{arabic}

\newpage
\thispagestyle{empty}
\rule{0cm}{1cm}
\definecolor{green}{rgb}{0,0.5,0}
\definecolor{red}{rgb}{0.8,0,0}
\definecolor{blue}{rgb}{0,0,0.5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tableofcontents

\newpage

\section{How to use this Manual}

The actual manuscript guides through the various options to set up a proper parameter file for a SeisSol simulation.
The parameter file must be specified for a correct job submission as\\
\\
\texttt{mpirun.openmpi -n NRprocs seissolxx PARAMETERS.par}\\
\\
that has usually the extension {\tt*.par} by convention.
SeisSol reads the file during initialization enabling run-time settings of various model parameters.
The routine \url{/src/Reader/readpar.f90} handles the reading
and can be modified for the introduction of further parameters and options.
The parameter file must be located in the current working directory or preceded by a link to its location.
We use Fortran's namelist approach which is structured by namelist blocks indicated by an ampersand \&
followed by the namelist's name and ends by a common slash /.
In such blocks parameter$=$option pairs can be set in arbitrary order.
Certain parameters require additional information in form of further input files,
which may be limited to static order.
Default options (as specified later in this document) are opt by leaving the namelist blocks empty or individual parameters are dropped.
However, the namelist blocks
\textbf{Equations, IniCondition, Boundaries, SourceType, SpongeLayer, MeshNml, Discretization, Output, AbortCriteria, Analysis, Debugging}\\
have be included even if not used as:\\

\noindent \&IniCondition\\
/\\

\noindent \&SpongeLayer\\
/\\


\hspace{5mm}$\vdots$  \\


\noindent
This manual is structured according to the available namelist blocks.
The tables will guide you in the following way to change the option of a parameter.\\
Black: The parameter has a default value. You only have to add this parameter to your namelist if you want to change its option.\\
\textcolor{green}{Green}: If changing a option requires setting other parameters, you have to add the green parameters.\\
\textcolor{red}{Red}:  If changing a option requires setting other parameters in a new namelist,
you have to add the red namelist with the green options.\\
\textcolor{blue}{Blue}: For some special cases you can find more information in this manual which is linked to the according blue words.


\subsection{Examples}

Documented example {\tt*.par} and input/output files are located in \url{/Documentation/Example_IO_Files/}.\\

\noindent A complete small example is provided in \url{/examples/small_example/}.

%\newpage

\section{Equations}
\label{sec-block-eqs}
This block handles the information related to the equations to be solved,
as well as all the material properties and similar basic information.
In the underlying ADER-DG method,
this is equivalent to specifying the shape and size of the Jacobian and reaction matrices to be used.
The size of the Jacobian (square) matrices is the same as the size of the vectors of unknowns,
and thus the larger they are the more computational cost is involved in their solution.
The standard for a SeisSol simulation is the elastic isotropic case, in which the Jacobian matrices have a size of $5$ (in 2D)
and $9$ (in 3D) and no reaction terms.
In this case, the flags for advection, anisotropy, anelasticity, poroelasticity
and the material file are set equal to 0 and the materials are described by only three material reference values,
namely $\rho$ (material density), $\mu$ and $\lambda$ (Lam{\' e} parameters).
This is fully described in \cite{KaeserDumbser06} and \cite{DumbserKaeser06}.\\

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Equations}
(if changing a value results in setting a new parameter in a different namelist, this namelist is written in red).
A blue keyword indicates a link to the according section:\\

\newpage

\begin{longtable}{|p{3cm}|p{2.4cm}|p{2cm}|p{5cm}|}%[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Equations}.
         changing the parameter from the default value often results in setting additional parameters in the corresponding namelist
         (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist,
         the namelist is written in red. The blue words represent
         links for navigating to a detailed description of the parameter.} \\
%\begin{center}
%\begin{tabular}{|p{3cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\hline
parameter & Default Value & Type & Short Description \\
\hline
\hline
rho   & 1. & real &  Material density \\
mu    & 1. & real & Lam\' e Parameter \\
lambda   & 1. & real & Lam\' e Parameter \\
\hline
\hyperlink{aniso}{\textcolor{blue}{Anisotropy}} & 0 & 0/1  & Different wave velocities in different directions.\\
\hdashline
\uline{Anisotropy} = 1 & & &\\
\textcolor{red}{Namelist 'Output'}: \textcolor{green}{iOutputMask(11)} & & 0/1 & Constants for Jacobian. Change this parameter in the namelist Output, which already exists.\\
\hline
\hyperlink{anelas}{\textcolor{blue}{Anelasticity}} & 0 & 0/1 & Viscoelastic dissipation or attenuation.\\
\hline
\hyperlink{plast}{\textcolor{blue}{Plasticity}} & 0 & 0/1 & Plastic material behaviour for the whole domain.\\
\hdashline
\uline{Plasticity} = 1 & & &\\
\textcolor{green} {PlastCo} & & real & plastic cohesion \\
\textcolor{green} {BulkFriction} & & real & bulk friction \\
\textcolor{green} {Tv} & & real & relaxation coefficient \\
\textcolor{green}{MaterialType} & & character & choose a material type to assign the initial background stress for the whole domain \\
\hline
Adjoint & 0 & 0/1  & Generating an adjoint field simultaneously.\\
\hdashline
\uline{Adjoint} = 1 & & &\\
\textcolor{green}{AdjFileName} & & character & read the adjoint wavefield in\\
\hline
MaterialType & 0 & & Indicates source and behaviour of material properties.\\
\hdashline
\uline{MaterialType} = 1,3-9, 11, 101 & & &\\
\textcolor{green}{MaterialFileName} & & character & Reads material parameters from \hyperlink{material}{\textcolor{blue}{file}}\\
\hdashline
\uline{MaterialType} = 2 and \uline{\hyperlink{anelas}{\textcolor{blue}{Anelasticity}}} = 1 & & &\\
\textcolor{green}{nMechanisms} & & integer & \# attenuation mechanisms\\
\textcolor{green}{FreqCentral} & & real & Central Frequency \\
\textcolor{green}{FreqRatio} & & real & Frequency ratio \\
\hline
RandomField\_Flag & 0 & integer & Material random fields\\
\hdashline
\uline{RandomField $\neq$ 0} & & &\\
\textcolor{red}{New Namelist 'RFFile'}: \textcolor{green}{RF\_Files} & & character & According to the number of random field flags the names of the
\hyperlink{random_field}{\textcolor{blue}{RF\_Files}} have to be set.\\
\hline
%\end{tabular}
%\end{center}
\label{eq-table}
\end{longtable}

\noindent
\hypertarget{aniso}{ANISOTROPY}: This option allows to use materials with different wave velocities in different directions,
usually described by the 21 independent coefficients of the general Hooke's tensor.
Isotropic materials are just particular cases of the anisotropic framework.
The size of the Jacobian matrices remains unchanged, and so anisotropy has little impact in the computational costs.
Setting the value of anisotropy equal to $1$ requires also setting the material file option to $1$.
Additional information can be found in \cite{PuenteKaeserDumbserIgel07}.\\


\noindent
\hypertarget{anelas}{ANELASTICITY}: This option allows to include viscoelastic dissipation or
attenuation using the Generalized Maxwell Body theory.
The attenuation is measured in terms of two quality factors $\Q$, one for the P- and one for the S-waves.
This value will then be approximated in a given frequency band by a series of attenuating mechanisms in order
to reproduce an almost frequency independent attenuation.
The use of this option enlarges the size of the Jacobian matrices by $3$ (in 2D) or $6$ (in 3D) per attenuating
mechanism used and causes the apparition of a reaction matrix.
As a consequence the computational costs increase and the user should choose carefully the number of mechanisms
required for his particular case.
A number between 2 and 5 mechanisms is considered acceptable for attenuating bandwidths of around 100Hz.
Setting the value of anelasticity to $1$ requires setting the material file option to $1$.
Additional information can be found in \cite{KaeserDumbserPuente07}.\\

\noindent
\hypertarget{plast}{PLASTICITY}:
This option enables the use of a Drucker-Prager yield criterion that is used to simulate plastic material behaviour. \\
Specifying $1$ as plasticity option requires three additional variables providing the parameters for plastic cohesion $c$, the bulk friction $v$ and a relaxation coefficient $T_v$. $T_v$ is used for the adjustment factor for the stresses when the material behaves plastically. For the relaxation coefficent, we recommend using a guiding value of $T_v\approx \frac{\Delta x / (\# BF)}{V_p}$ where $\Delta x$ is the smallest distance between two nodes, $\# BF$ is the number of basis functions (depending on the approximation order) and $V_sÂ§$ is the S-wave velocity. \\
When using the plasticity option, the user has to specify initial background stresses for every element in the domain.
For assigning an initial background stress, please write an additional material case in the file\\
 {\tt /trunk/src/Physics/ini\_ model.f90} \\
 by adding another case to the variable {\tt EQN\%LinType}. This additional case is read in in 'MaterialType' inside the Equations block. Further, the user needs to add this material case  in the file readpar.f90.\\
\noindent \uline{The Drucker-Prager yield criterion}: \\
In every time step and for every element the values for normal and shear stresses are first calculated elastically. Then the yield criterion and the maximized shear stress over all orientations are calculated for the elastic values ( added the initial background stresses):
\begin{eqnarray*}
\tau_c &=& c\cdot \cos \phi-\sigma_m\cdot \sin \phi \\
\tau_{max} &=& \sqrt{\sigma^2_{xy}+(\sigma_{xx}-\sigma_{yy})/2)^2},
\end{eqnarray*}
where $c$ is the plastic cohesion, $\phi=\arctan(v)$ the internal coeffcient of friction for the bulk friction $v$ and $\sigma_m$ the mean stress.\\
If the yield criterion($\tau_c < \tau_{max}$) is violated, the deviatoric stresses are adjusted by the factor $1-(1-\tau_c/\tau_{max})(1-\exp(-\Delta t /T_v))$, for the timestep $\Delta t$ and $T_v$ as stated above. The initial background stress is then subtracted such that it is only used to check the yield criterion.
For further information see /trunk/src/Solver/plasticity.f90 or \cite{Andrews2005}.

\newpage

\subsection{Material File}
\label{sec-matfile}

\hypertarget{material}{A material file is required} in the following cases:
either the user wants to treat heterogeneous materials or
at least one of the anisotropy, anelasticity or poroelasticity options is activated.
When option $1$ is selected for the material file, the name of the material file, which has a {\tt .def} extension by convention,
has to be given.
Additionally, the three values set as material reference values will become now dummy values now.

\noindent
A general material file will always begin by defining the number of material zones N existing in our simulation.
This number must be the same as the zones defined in our mesh.
Then, for each of this zones 1,...,N we must first give the zone index and then a series of $m$ material values,
depending on the rheology type the user has chosen.
Material properties can also be individually applied to each element.
In this case, each element can be considered and is treated as a zone without specifying any zones in the mesh generator.
In this particular case of element-wise material properties the number of zones at the beginning of
the material definition file has to equal the total number of elements.\\

\noindent
Elastic Isotropic ($m=3$): $\rho$, $\mu$ and $\lambda$.\\

\noindent
Elastic Anisotropic ($m=31$): $\rho$, $c_{11}$, $c_{12}$, $c_{13}$, $c_{14}$, $c_{15}$, $c_{16}$, $c_{22}$, $c_{23}$, $c_{24}$, $c_{25}$, $c_{26}$, $c_{33}$, $c_{34}$, $c_{35}$,
$c_{36}$, $c_{44}$, $c_{45}$, $c_{46}$, $c_{55}$, $c_{56}$, $c_{66}$, $n_x$, $n_y$, $n_z$, $s_x$, $s_y$, $s_z$, $t_x$, $t_y$, $t_z$.\\

\noindent
Poroelastic ($m=42$):$\rho_S$, $c_{11}$, $c_{12}$, $c_{13}$, $c_{14}$, $c_{15}$, $c_{16}$, $c_{22}$, $c_{23}$, $c_{24}$, $c_{25}$, $c_{26}$, $c_{33}$, $c_{34}$, $c_{35}$,
$c_{36}$, $c_{44}$, $c_{45}$, $c_{46}$, $c_{55}$, $c_{56}$, $c_{66}$, $\rho_F$, $K_F$, $\nu$, $K_S$, $\phi$, $\kappa_1$, $\kappa_2$, $\kappa_3$, $T_1$, $T_2$, $T_3$, $n_x$,
$n_y$, $n_z$, $s_x$, $s_y$, $s_z$, $t_x$, $t_y$, $t_z$.\\

\noindent
where the $\vec n$, $\vec s$ and $\vec t$ entries are the directions of the three coordinate axis
in which is defined the material described in the material file.
The reader is addressed to the bibliography for the description of each of these parameters.\\

\noindent
In the anelastic case, we must add three lines after the first,
which define the number of attenuating mechanisms, central frequency and bandwidth of the attenuating mechanisms
given by the ratio of the maximum to minimum frequency over which the Q-law is approximated by the attenuation mechanisms.
Those apply to all material zones.
Then, attenuation will be described individually for each zone by adding two additional values to the material properties
(that means $m_{new}=m_{old}+2$) which are the $\Q$ factors for the P- and S-waves at that particular zone.
Those values have to be typed after all the other parameter values but before the $\vec n$, $\vec s$ and $\vec t$ entries, if present.
A value of $\Q$ higher than $9999$ in any of those implies that no attenuation is considered in that particular layer.
Note, that in the anelastic material case the material parameters $\lambda$ and $\mu$
are frequency dependent and therefore have to be specified for the central frequency as given in line $2$ of the
material definition file.

\noindent
Notice, that acoustic wave propagation can be simulated by setting $\mu=0$.
This way the code understands that the value set for the $\lambda$ parameter corresponds to the acoustic bulk modulus $K$.
It should also be remarked that values higher than $1$ are possible for the material file value,
but those correspond to specific cases not covered in the present general manual.

\begin{table}
\caption{Structure of material file}
\begin{center}
\begin{tabular}{lllll}
\hline
\multicolumn{4}{l}{Values}  &  Description          \\
\hline
\#I    & \multicolumn{3}{l}{ }          &  Number of material zones (referred to as N)             \\
{\color{gray}\#I  }  & \multicolumn{3}{l}{ }          &  {\color{gray}Number of attenuating mechanisms  }    \\
{\color{gray}\#R  }  & \multicolumn{3}{l}{ }          &  {\color{gray}Central frequency of attenuation  bandwidth } \\
{\color{gray}\#R  }  & \multicolumn{3}{l}{ }          &  {\color{gray}Bandwidth of attenuation }             \\
1    & \#R$_1$ & $\cdots$ & \#R$_m$ & Index of zone and $m$ material parameters for zone $1$\\
{\color{gray}$\vdots$ }& \multicolumn{4}{l}{ } \\
{\color{gray} N}    & {\color{gray}\#R$_1$} & {\color{gray}$\cdots$} & {\color{gray}\#R$_m$} & {\color{gray}Index of zone and $m$ material parameters for zone N}\\
\hline
\end{tabular}
\end{center}
\label{matfile-table}
\end{table}

\subsection{Random Field File}
\label{sec-ranfile}

\hypertarget{random_field}{When random} distribution material properties are used we set this flag equal to
the number of zones in the model affected by the randomness. This imply that we
set also the Material File flag to 1. In the next lines we introduce the names
of the files that describe the random properties for each zone affected. The
perturbation values (e.g. $\Delta\rho,\Delta\mu,\Delta\lambda$) are added to the
background material parameters (e.g. $\rho,\mu,\lambda$). The structure of the
random field file and an example are given in Tab. \ref{randfile-table} and Tab.
\ref{randfileexample-table} respectively.

\begin{table}
\caption{Structure of random field file}
\begin{center}
\begin{tabular}{lll}
\hline
Values & & Description \\
\hline
\#I \; \#I & & Zone number \; Number of affected material parameters \\
\#I \; \#I \; \#I & \#I$_1 \dots $\#I$_m$ & Number of samples (NX NY NZ) \;
Material parameter indices \\
\#R \; \#R \; \#R & \#R$_1 \dots $\#R$_m$ & Location $(X Y Z)$ \;
Perturbation for 1st $\dots$ mth material parameter \\
\hline
\end{tabular}
\end{center}
\label{randfile-table}
\end{table}

\begin{table}
\caption{Example of random field file}
\begin{center}
\begin{tabular}{llllll}
\hline
1 & 3 & & & & \\
10 & 20 & 30 & 1 & 2 & 3 \\
X$_1$ & Y$_1$ & Z$_1$ & $\Delta\rho_1$ & $\Delta\mu_1$ & $\Delta\lambda_1$ \\
X$_1$ & Y$_1$ & Z$_2$ & $\Delta\rho_2$ & $\Delta\mu_2$ & $\Delta\lambda_2$ \\
X$_1$ & Y$_1$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
X$_1$ & Y$_1$ & Z$_{30}$ & $\Delta\rho_{30}$ & $\Delta\mu_{30}$ &
$\Delta\lambda_{30}$ \\
X$_1$ & Y$_2$ & Z$_1$ & $\Delta\rho_{31}$ & $\Delta\mu_{31}$ &
$\Delta\lambda_{31}$ \\
X$_1$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
X$_1$ & Y$_{20}$ & Z$_{30}$ & $\Delta\rho_{600}$ & $\Delta\mu_{600}$ &
$\Delta\lambda_{600}$ \\
X$_2$ & Y$_{20}$ & Z$_{30}$ & $\Delta\rho_{601}$ & $\Delta\mu_{601}$ &
$\Delta\lambda_{601}$ \\
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
X$_{10}$ & $Y_{20}$ & $Z_{30}$ & $\Delta\rho_{6000}$ & $\Delta\mu_{6000}$ &
$\Delta\lambda_{6000}$ \\
\hline
\end{tabular}
\end{center}
\label{randfileexample-table}
\end{table}

\newpage

\section{Initial Condition}
\label{sec-block-ic}

In the following, we list all parameters with their possible and default values to be set in the namelist  \textbf{IniCondition}
If changing a value requires setting a new
parameter it is indicated in green after the dashed line:\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{IniCondition}.
         Changing the parameter from the default value often results in setting additional parameters in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.6cm}|p{2cm}|p{5cm}|}
\hline
parameter & Default Value & Type & Short Description \\
\hline
\hline
variable & 1 & integer & \\
xc(:) & 0.0 & real &\\
amplitude & 0.0 & real &\\
hwidth(:) & 5.0e3 & real &\\
\hline
cICType & Gauss\_Puls\_Rad & character & Defines the type of initial condition.\\
\hdashline
\uline{cICType} = Var\_Gauss\_Puls, Char\_Gauss\_Puls, Char\_Ricker\_Puls, Planarwave\_Gauss\_Puls, Planarwave\_Ricker\_Puls, Planarwave, PlanarwaveAnel,
PlanarwaveAn, PlanarwaveAniso & & &\\
\textcolor{green}{IniConditionFile} & & character & Reads variables from file.\\
\hline
\end{tabular}
\end{center}
\label{ini-table}
\end{table}

\newpage

\subsection{IniConditionFile}

\subsubsection{'Var\_Gauss\_Puls', 'Char\_Gauss\_Puls', 'Char\_Ricker\_Puls'}

\begin{table}[H]
\caption{Structure of the initial condition file in the cases of the Var\_Gauss\_Puls', 'Char\_Gauss\_Puls' and 'Char\_Ricker\_Puls'.}
\begin{center}
\begin{tabular}{l}
\hline
Homogeneous background; 2D: vector(5), 3D: vector(9)\\
setvar\\
variables\\
amplitudes\\
center coordinates (x, y, z)\\
Halfwidths (x, y, z)\\
Read normal direction of GP coord. system\\
Read tangent 1 direction of GP coord. system\\
\hline
\end{tabular}
\end{center}
\label{ini1-file}
\end{table}





\subsubsection{'Planarwave\_Gauss\_Puls','Planarwave\_Ricker\_Puls'}

\begin{table}[H]
\caption{Structure of the initial condition file in the cases of the 'Planarwave\_Gauss\_Puls' and 'Planarwave\_Ricker\_Puls'.}
\begin{center}
\begin{tabular}{l}
\hline
Homogeneous background; 2D: vector(5), 3D: vector(9)\\
setvar\\
variables\\
amplitudes\\
center coordinates (x, y, z)\\
Halfwidths (x, y, z)\\
Read normal direction of GP coord. system\\
Read tangent 1 direction of GP coord. system\\
File Name for data for eigenvectors and eigenvalues\\
\hline
\end{tabular}
\end{center}
\label{ini2-file}
\end{table}

\newpage

\uline{\textbf{EigenVecValName}}

\begin{table}[H]
\caption{Structure of the eigenvector/value file in the cases of the 'Planarwave\_Gauss\_Puls' and 'Planarwave\_Ricker\_Puls'.}
\begin{center}
\begin{tabular}{l}
\hline
 cdummy\\
 \# Eigenvalues\\
 cdummy\\
 Read eigenvalues (insert one line for each eigenvalue)\\
 Read eigenvectors (insert one line for each eigenvector)\\
\hline
\end{tabular}
\end{center}
\label{eigenvec1-file}
\end{table}

\subsubsection{'Planarwave'}

\begin{table}[H]
\caption{Structure of the initial condition file in the cases of the 'Planarwave'.}
\begin{center}
\begin{tabular}{l}
\hline
Homogeneous background; 2D: vector(5), 3D: vector(9)\\
setvar\\
variables\\
amplitudes\\
iLambda ('0' or default)\\
case lambda = 0: Read directly the 3D wavenumber vector; case default: Read 3D wavelength vector\\
\hline
\end{tabular}
\end{center}
\label{ini3-file}
\end{table}

\newpage

\subsubsection{'PlanarwaveAnel','PlanarwaveAn', 'PlanarwaveAniso'}

\begin{table}[H]
\caption{Structure of the initial condition file in the cases of the 'PlanarwaveAnel', 'PlanarwaveAn' and 'PlanarwaveAniso'.}
\begin{center}
\begin{tabular}{l}
\hline
Homogeneous background; 2D: vector(5), 3D: vector(9)\\
setvar\\
variables\\
amplitudes\\
File Name for data for eigenvectors and eigenvalues\\
\hline
\end{tabular}
\end{center}
\label{ini4-file}
\end{table}



\uline{\textbf{EigenVecValName}}

\begin{table}[H]
\caption{Structure of the eigenvector/value file in the cases of the 'PlanarwaveAnel', 'PlanarwaveAn' and 'PlanarwaveAniso'.}
\begin{center}
\begin{tabular}{l}
\hline
 cdummy\\
 \# Eigenvalues\\
 cdummy\\
 read wavenumbers\\
 cdummy\\
 Read eigenvalues (insert one line for each eigenvalue)\\
 Read eigenvectors (insert one line for each eigenvector)\\
\hline
\end{tabular}
\end{center}
\label{eigenvec2-file}
\end{table}


\newpage

\section{Boundaries}
\label{sec-block-bnd}

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Boundaries}.
If changing a value requires setting a new parameter it is indicated in green after the dashed line
(if changing a value results in setting a new parameter in a different namelist, this namelist is written in red).
A blue keyword indicates a link to the according section:\\

\newpage

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Boundaries}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist,
         the namelist is written in red. The blue words represent
         links for navigating to a detailed description of the parameter.}
\begin{center}
\begin{tabular}{|p{4.5cm}|p{2.4cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
BC\_fs & 0 & integer & \# free surfaces boundaries.\\
BC\_nc & 0 & integer & \# non-conforming boundaries.\\
BC\_dr & 0 & integer & \# fault inner boundaries.\\
\hdashline
\uline{BC\_dr} $\neq$ 0 & & &\\
\textcolor{red}{New namelist:} & & &\\
\hyperlink{dynrupture}{\textcolor{blue}{DynamicRupture}} & & &\\
\hline
BC\_if & 0 & integer & \# inflow boundaries.\\
\hdashline
\uline{BC\_if} $\neq$ 0 & & &\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{InflowBounduin} & & &\\
u0\_in &  & real & \\
\textbf{$+$} &  & & \\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{InflowBound} & & &\\
setvar & 0 & integer & dimension of varfield vector.\\
\textcolor{green}{char\_option} &  & character & Inflow boundary conditions (different possibilities):
                              Char\_Gauss\_Puls, Char\_Ricker\_Puls, Custom\_PlaneWave\_File.\\
\hdashline
\uline{char\_option} = Custom\_PlaneWave\_File & & &\\
PWFileName & 0 & integer & Wave time histories read from file.\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{InflowBoundPWFile} & & &\\
varfield & 0 & integer & \# periodic boundaries.\\
\hline
BC\_of & 0 & integer & \# outflow boundaries.\\
BC\_pe & 0 & integer & \# periodic boundaries.\\
\hline
\end{tabular}
\end{center}
\label{bound-table}
\end{table}
\newpage

\section{Dynamic Rupture}
\noindent
If \hypertarget{dynrupture}{dynamic rupture} is simulated set rupture inner boundaries to 1
and add the new namelist \textbf{DynamicRupture}.
Dynamic rupture is treated in SeisSol as a boundary condition and, thus, is not listed in the source section.
For details about its implementation and the theory we refer to \cite{Pelties12} and \cite{Pelties14}.
\\

\noindent
Since the namelist \textbf{DynamicRupture} requires many additional parameters,
the structure of the tabulars differs slightly from the rest of the tabulars in this documentation.
For changing the three parameters Backgroundtype, Friction Law and Nucleation
you can find three additional tabulars below (\ref{bt-table}, \ref{fl-table},
 \ref{nuc-table}).

\newpage

\begin{longtable}{|p{4.8cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\caption{Parameters and their default values as well as type for the namelist \textbf{DynamicRupture}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist,
         the namelist is written in red. If you change the value for
         \textit{BackgroundType}, \textit{FL} or \textit{Nucelation}, add the table \ref{bt-table},
         \ref{fl-table}, \ref{nuc-table}, respectively.} \\
%\begin{center}
%\begin{tabular}{|p{4.8cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
BackgroundType & 0 & integer & Type of the stress background. For changing the parameter go to \ref{bt-table}.\\
\hline
FL & 0 & integer & Type of the Friction Law. For changing the parameter go to \ref{fl-table}.\\
\hline
Nucleation & 0 & integer &  Characteristics of the Nucleation Patch. For changing the parameter go to \ref{nuc-table}.\\
\hline
RF\_output\_on & 0 & 0/1 & Rupture front output off/on\\
\hline
magnitude\_output\_on & 0 & 0/1 & output scalar seismic moment off/on\\
\hline
energy\_rate\_output\_on & 0 & 0/1 & output of fault energy rate (currently: scalar seismic moment rate and frictional energy rate) off/on\\
\hline
\textcolor{green}{energy\_rate\_printtimeinterval} & 1 & integer & print time interval for fault energy rate output\\
\hline
cohesion\_0 & 0 & real & Default cohesion value\\
\hline
read\_fault\_file & 0 & 0/1 & Input of fault parameters from Par\_file\_faults off/on (see section \ref{subsec-faultinput})\\
\hline
OutputPointType & 3 & integer & Output is Pickpointwise.\\
\hdashline
\uline{OutputPointType} = 3 & & &\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{Pickpoint} & & &\\
\textcolor{green}{printtimeinterval} & 2 & integer & Timeinterval\\
\textcolor{green}{OutputMask} & (1, 1, 1, 0) & integer & \\
\textcolor{green}{nOutPoints} & & integer & \# Output points\\
\textcolor{green}{PPFileName} & & character& File where Pickpoints are listed; x, y, z next to each other separated by a space;\\
\hdashline
\uline{OutputPointType} = 4 & & &\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{Elementwise} & & &\\
\textcolor{green}{printIntervalCriterion} & 1 & integer & 1=iteration, 2=time\\
\textcolor{green}{printtimeinterval} & 2 & integer & Time interval (iterations)\\
\textcolor{green}{printtimeinterval\_sec} & 1.0 & real & Time interval (seconds)\\
\textcolor{green}{OutputMask} & (1, 1, 1, 0, 1, 0, 0, 0, 0)& integer & 1/ slip rate 2/ stress 3/ normal velocity 4/ in case of rate and state output friction and state variable
                               ! 5/ background values 6/ strike and dip slip 7/ rupture velocity (require RF output) 8/Cumulated slip 9/Peak slip rate\\
\textcolor{green}{refinement\_strategy} & 2 & integer & \\
\textcolor{green}{refinement} & 2 & integer & \\
\hdashline
\uline{OutputPointType} = 5 & & &\\
\textcolor{red}{Add both namelists:} & & &\\
\textcolor{red}{Pickpoint} and \textcolor{red}{Elementwise} & & &\\
\hline
%\end{tabular}
%\end{center}
\end{longtable}

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{DynamicRupture},
         if you have set \textit{BackgoundType}
         unequal to 0. Changing the parameter from the default value often results in
         setting additional parameters in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
BackgroundType & 0 & integer & Type of the stress background.\\
\hdashline
\uline{BackgroundType} = 0-5, 7, 10, 11, 14, 15, 50, 100, 101, 103 & & &\\
\textcolor{green}{Bulk\_xx\_0} & & real & \\
\textcolor{green}{Bulk\_yy\_0} & & real & \\
\textcolor{green}{Bulk\_zz\_0} & & real &\\
\textcolor{green}{ShearXY\_0} & & real &\\
\textcolor{green}{ShearYZ\_0} & & real &\\
\textcolor{green}{ShearXZ\_0} & & real &\\
\textcolor{green}{RS\_sv0} & & real &\\
\textcolor{green}{XRef} & & real &\\
\textcolor{green}{YRef} & & real &\\
\textcolor{green}{ZRef} & & real &\\
\hdashline
\uline{BackgroundType} = 16, 17 & & &\\
\textcolor{green}{FileName\_BackgroundStress} & & character & Background stress read from file.\\
\textcolor{green}{GPwise} & & 0/1 & 0 for elementwise, 1 for gridpointwise.\\
\textcolor{green}{XRef} & & real & reference point\\
\textcolor{green}{YRef} & & real & reference point\\
\textcolor{green}{ZRef} & & real & reference point\\
\hline
\end{tabular}
\end{center}
\label{bt-table}
\end{table}

\newpage

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{DynamicRupture},
         if you have set \textit{FL} unequal to 0.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
FL & 0 & integer & Type of the friction Law\\
\hdashline
\uline{FL} = 1 & & &\\
\textcolor{green}{Rupspeed} & & real & Rupture Speed. \\
\textcolor{green}{Mu\_D\_ini} & &  real & \\
\textcolor{green}{Mu\_S\_ini} & &  real & \\
\textcolor{green}{H\_Length} & & real  & \\
\hdashline
\uline{FL} = 2 & & &\\
\textcolor{green}{Mu\_D\_ini} & & real  & \\
\textcolor{green}{Mu\_S\_ini} & & real  & \\
\textcolor{green}{D\_C\_ini} & &  real & \\
\textcolor{green}{inst\_healing} & & 0/1 & Instantaneous healing switch. \\
\hdashline
\uline{FL} = 3, 4 ,7, 101 & &real  &\\
\textcolor{green}{RS\_f0} & &  real & \\
\textcolor{green}{RS\_sr0} & & real  & \\
\textcolor{green}{RS\_a} & &  real & \\
\textcolor{green}{RS\_b} & &  real & \\
\textcolor{green}{RS\_sl0} & & real  & \\
\textcolor{green}{RS\_iniSlipRate1} & &  real & \\
\textcolor{green}{RS\_iniSlipRate2} & & real  & \\
\hdashline
\uline{FL} = 6 & & &\\
\textcolor{green}{Mu\_D\_ini} & & real & \\
\textcolor{green}{Mu\_S\_ini} & &real  & \\
\textcolor{green}{D\_C\_ini} & & real & \\
\textcolor{green}{v\_star} & & real & \\
\textcolor{green}{L} & & real & \\
\hdashline
\uline{FL} = 16, 17 & & & Parameters are already defined in the input file\\
\hdashline
\uline{FL} = 103 & & &\\
\textcolor{green}{RS\_f0} & & real & \\
\textcolor{green}{RS\_sr0} & & real & \\
\textcolor{green}{RS\_a} & & real & \\
\textcolor{green}{RS\_b} & & real & \\
\textcolor{green}{RS\_sl0} & & real & \\
\textcolor{green}{Mu\_W} & & real & \\
\textcolor{green}{RS\_srW} & & real & \\
\textcolor{green}{RS\_iniSlipRate1} & & real & \\
\textcolor{green}{RS\_iniSlipRate2} & & real & \\
\hline
\end{tabular}
\end{center}
\label{fl-table}
\end{table}

\newpage

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{DynamicRupture},
         if you have set \textit{Nucleation} unequal to zero.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2.4cm}|p{2cm}|p{5cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
Nucleation & 0 & integer & Characteristics of the nucleation patch type.\\
\hline
\uline{Nucleation} = 1 & & & square patch\\
\hdashline
\textcolor{green}{NucDirX} & & real & \\
\textcolor{green}{NucXmin} & & real & \\
\textcolor{green}{NucXmax} & & real & \\
\textcolor{green}{NucDirY} & & real & \\
\textcolor{green}{NucYmin} & & real & \\
\textcolor{green}{NucYmax} & & real & \\
\textcolor{green}{NucBulk\_xx\_0} & & real & \\
\textcolor{green}{NucBulk\_yy\_0} & & real & \\
\textcolor{green}{NucBulk\_zz\_0} & & real & \\
\textcolor{green}{NucShearXY\_0} & & real & \\
\textcolor{green}{NucShearYZ\_0} & & real & \\
\textcolor{green}{NucShearXZ\_0} & & real & \\
\textcolor{green}{NucRS\_sv0} & & real & \\
\hline
\uline{Nucleation} = 2,3 & & real & smooth (2) or discontinuous (3) elliptical patch\\
\textcolor{green}{NucDirX} & & real & \\
\textcolor{green}{NucXmin} & & real & \\
\textcolor{green}{NucXmax} & & real & \\
\textcolor{green}{NucDirY} & & real & \\
\textcolor{green}{NucYmin} & & real & \\
\textcolor{green}{NucYmax} & & real & \\
\textcolor{green}{r\_s} & & real & \\
\textcolor{green}{NucBulk\_xx\_0} & & real & \\
\textcolor{green}{NucBulk\_yy\_0} & & real & \\
\textcolor{green}{NucBulk\_zz\_0} & & real & \\
\textcolor{green}{NucShearXY\_0} & & real & \\
\textcolor{green}{NucShearYZ\_0} & & real & \\
\textcolor{green}{NucShearXZ\_0} & & real & \\
\textcolor{green}{NucRS\_sv0} & & real & \\
\hline
\end{tabular}
\end{center}
\label{nuc-table}
\end{table}

\subsection{Fault input using Par\_file\_faults} \label{subsec-faultinput}

Apart from defining basic values in the namelist \texttt{DynamicRupture} and coding most of the background parameters in \texttt{Physics/ini\_model\_DR.f90},
fault parameters can also be read in from a text file called \texttt{Par\_file\_faults}. This feature is enabled by setting \texttt{read\_fault\_file} in the \texttt{DynamicRupture} namelist to 1.
Values set in this file have priority over values set in the PARAMETER-file and over those set in the subroutines in \texttt{Physics/ini\_model\_DR.f90}.
For sign and vector conventions see \texttt{RD\_sign\_conventions.pdf}. These conventions are compatible with SPECFEM3D.

The file uses namelists defining different geometric shapes to specify the parameters. The stress field and slip-weakening friction input can be written in a SPECFEM3D-compatible style. The \texttt{Par\_file\_faults} file from SPECFEM3D can simply be copied into the working directory and SeisSol will interpret these parts correctly (see section \ref{subsubsec-specfem3d}).

\subsubsection{Heterogeneous distribution blocks (DIST2D-blocks)} \label{subsubsec-dist2d}

DIST2D-blocks use different geometric shapes for specifying heterogeneous distributions of different parameters. The parameter on all boundary Gaussian points inside of a specified shape is set to the given value. This means that for the specified parameter $p$ at the boundary Gaussian point with coordinates $\vec{x}$

\begin{equation}
p(\vec{x}) =
\begin{cases}
 a, & \vec{x} \in V \\
 p_\text{prev}(\vec{x}), & \text{otherwise}
\end{cases}
\end{equation}

with $a$ being the value specified in the distribution block, $V$ the volume defined by the block's shape and $p_\text{prev}(\vec{x})$ the value the parameter previously had.


The values specified in these blocks are exclusive for each parameter, they are not added up. The \emph{last} block in which a point lies specifies the value of the specified parameter. The stress fields in local and global coordinates are added up.

For example, to set up a homogeneous stress field with a nucleation patch, a global shape for the homogeneous stress field and afterwards a rectangular shape for the nucleation patch could be specified.

If SPECFEM3D namelists are present, the first blocks are used for the ones specified in these namelists (see section \ref{subsubsec-specfem3d}). The values of \texttt{param} and \texttt{dir} are ignored for these blocks.

\newpage

\begin{longtable}{|p{4.8cm}|p{2cm}|p{2cm}|p{5.4cm}|}
\caption{Namelist \textbf{DIST2D}, used for setting the value of a parameter inside a geometric shape to a given value.}\\
\hline
Parameter & Default value & Type & Short description \\
\hline
\hline
\textbf{param} & \textquotesingle\ \textquotesingle & string & String defining the parameter on which this block acts\\
\hdashline
\uline{param} = 'globalstress' & & & Stress field using global xyz-coordinates\vspace{0.25cm}\\
\textcolor{green}{dir} & \textquotesingle\ \textquotesingle & string & Stress field direction\\
\hdashline
\uline{param} = 'localstress' & & & Stress field using fault-local coordinates\vspace{0.25cm}\\
\textcolor{green}{dir} & \textquotesingle\ \textquotesingle & string & Stress field direction\\
\hdashline
\uline{param} = 'cohesion' & & & Fault cohesion (negative, since compression is negative normal stress)\\
\hdashline
\textit{Rate-and-state friction} \vspace{0.2cm} & & & \\
\uline{param} = 'd\_c' & & & Critical slip\\
\uline{param} = 'inistatevar' & & & Initial state variable used for rate-and-state friction\\
\uline{param} = 'rs\_a' & & & RS constitutive parameter "a"\\
\uline{param} = 'rs\_srw' & & & Velocity weakening scale\\
\uline{param} = 'inimu' & & & Initial friction coefficient\\
\hdashline
\textit{Linear slip-weakening friction} \vspace{0.2cm} & & & $\mu =
\begin{cases}
 \mu_\text{s} - \frac{\mu_\text{s} - \mu_\text{d}}{D_\text{c}}\delta, & \delta < D_\text{c}\\
 \mu_\text{d}, & \delta \ge D_\text{c}
\end{cases}$\\
\uline{param} = 'd\_c' & & & Critical slip-weakening distance\\
\uline{param} = 'mu\_s' & & & Static friction coefficient\\
\uline{param} = 'mu\_d' & & & Dynamic friction coefficient\\
\hdashline
\uline{param} = 'strength' & & & Strength parameter $S=\frac{\tau_\text{s} - \tau_\text{0}}{\tau_\text{0}-\tau_\text{d}}$ (static and dynamic tractions $\tau_\text{s}$ and $\tau_\text{d}$, shear traction $\tau_\text{0}$). Use only if no initial stress field is given.\\
\hline
\textbf{dir} & \textquotesingle\ \textquotesingle & string & String defining the stress field direction on which this block acts\\
\hdashline
\uline{param} = 'globalstress' & & & \vspace{0.25cm}\\
\uline{dir} = 'xx' & & & Bulk stress xx-component\\
\uline{dir} = 'yy' & & & Bulk stress yy-component\\
\uline{dir} = 'zz' & & & Bulk stress zz-component\\
\uline{dir} = 'xy' & & & Shear stress xy-component\\
\uline{dir} = 'yz' & & & Shear stress yz-component\\
\uline{dir} = 'xz' & & & Shear stress xz-component\\
\hdashline
\uline{param} = 'localstress' & & & \vspace{0.25cm}\\
\uline{dir} = 'strike' & & & Along-strike shear stress\\
\uline{dir} = 'dip' & & & Along-dip shear stress\\
\uline{dir} = 'normal' & & & fault-normal stress (negative is compression)\\
\hline
\textbf{shapeval} & \textquotesingle\ \textquotesingle & string & String defining the shape of this block\\
\hdashline
\uline{shapeval} = 'global' & & & The parameter at all points is assigned to this value\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\hdashline
\uline{shapeval} = 'square' & & & Cube\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{l} & 0 & real & Side length of the cube\\
\hdashline
\uline{shapeval} = 'rectangle' & & & Cuboid\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{lx} & 0 & real & length of the cuboid along x\\
\textcolor{green}{ly} & 0 & real & length of the cuboid along y\\
\textcolor{green}{lz} & 0 & real & length of the cuboid along z\\
\hdashline
\uline{shapeval} = 'rectangle-taper' & & & Cuboid with a linear variation of the value along the z-direction\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter at $z=z_\text{c}-l_\text{z}/2$\\
\textcolor{green}{valh} & 0 & real & Value of the parameter at $z=z_\text{c}+l_\text{z}/2$\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{lx} & 0 & real & length of the cuboid along x\\
\textcolor{green}{ly} & 0 & real & length of the cuboid along y\\
\textcolor{green}{lz} & 0 & real & length of the cuboid along z\\
\hdashline
\uline{shapeval} = 'circle' & & & Sphere\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{r} & 0 & real & Radius of the sphere\\
\hdashline
\uline{shapeval} = 'ellipse' & & & Ellipsoid with semiaxes along x-, y- and z-direction\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{lx} & 0 & real & Length of semiaxis along x\\
\textcolor{green}{ly} & 0 & real & Length of semiaxis along y\\
\textcolor{green}{lz} & 0 & real & Length of semiaxis along z\\
\hdashline
\uline{shapeval} = 'x-cylinder' & & & Cylinder with central axis along x-direction\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{r} & 0 & real & Radius of the base circle\\
\textcolor{green}{lz} & 0 & real & Height of the cylinder\\
\hdashline
\uline{shapeval} = 'y-cylinder' & & & Cylinder with central axis along y-direction\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{r} & 0 & real & Radius of the base circle\\
\textcolor{green}{lz} & 0 & real & Height of the cylinder\\
\hdashline
\uline{shapeval} = 'z-cylinder' & & & Cylinder with central axis along z-direction\vspace{0.25cm}\\
\textcolor{green}{val} & 0 & real & Value of the parameter\\
\textcolor{green}{xc} & 0 & real & x-coordinate of the center\\
\textcolor{green}{yc} & 0 & real & y-coordinate of the center\\
\textcolor{green}{zc} & 0 & real & z-coordinate of the center\\
\textcolor{green}{r} & 0 & real & Radius of the base circle\\
\textcolor{green}{lz} & 0 & real & Height of the cylinder\\
\hline
\label{DIST2D-table}
\end{longtable}

\subsubsection{SPECFEM3D namelists} \label{subsubsec-specfem3d}

The file can optionally start with a part in the syntax of the SPECFEM3D\linebreak \texttt{Par\_file\_faults} file. The purpose of this section is primarily offering compatibility with this format. The functionality offered by directly using heterogeneous blocks with a value for \texttt{param} (DIST2D-blocks, described in section \ref{subsubsec-dist2d}) is more powerful.

In addition to the DIST2D-blocks, SPECFEM3D files use three different namelists for specifying the stress field and the slip-weakening friction parameters:\linebreak \texttt{stress\_tensor}, \texttt{init\_stress} and \texttt{SWF}. The first DIST2D-blocks in the file are interpreted as those specified in \texttt{init\_stress} (in the order 1. along-strike, 2. along-dip, 3. normal). The blocks after these are interpreted as those specified in \texttt{SWF} (in the order 1. static friction coefficient, 2. dynamic friction coefficient, 3. critical slip-weakening distance). All the following blocks are interpreted using the value in \texttt{param}.

\begin{table}[H]
\caption{Namelist \textbf{init\_stress}, used for defining a homogeneous stress field in fault-local coordinates
	and specifying a number of heterogeneous blocks (DIST2D-blocks) for a heterogeneous stress field in fault-local coordinates}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2cm}|p{2cm}|p{5.4cm}|}
\hline
Parameter & Default value & Type & Short description \\
\hline
\hline
S1 & 0 & real & Initial homogeneous along-strike shear stress\\
S2 & 0 & real & Initial homogeneous along-dip shear stress\\
S3 & 0 & real & Initial homogeneous fault-normal stress (negative is compression)\\
n1 & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for along-strike shear stress\\
n2 & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for along-dip shear stress\\
n3 & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for fault-normal stress\\
\hline
\end{tabular}
\end{center}
\label{init_stress-table}
\end{table}

\begin{table}[H]
\caption{Namelist \textbf{stress\_tensor}, used for defining a homogeneous stress field in global XYZ-coordinates}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2cm}|p{2cm}|p{5.4cm}|}
\hline
Parameter & Default value & Type & Short description \\
\hline
\hline
Sigma & 0 0 0 0 0 0 & real & Initial homogeneous stress field, components: XX, YY, ZZ, XY, YZ, XZ\\
\hline
\end{tabular}
\end{center}
\label{stress_tensor-table}
\end{table}

\begin{table}[H]
\caption{Namelist \textbf{SWF}, used for defining homogeneous slip-weakening friction parameters
	and specifying a number of DIST2D-blocks for heterogeneous parameters}
\begin{center}
\begin{tabular}{|p{4.8cm}|p{2cm}|p{2cm}|p{5.4cm}|}
\hline
Parameter & Default value & Type & Short description \\
\hline
\hline
mus & 0 & real & Homogeneous static friction coefficient\\
mud & 0 & real & Homogeneous dynamic friction coefficient\\
dc & 0 & real & Homogeneous critical slip-weakening distance\\
nmus & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for the static friction coefficient\\
nmud & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for the dynamic friction coefficient\\
ndc & 0 & integer & Number of heterogeneous blocks (DIST2D-blocks) for the critical slip-weakening distance\\
\hline
\end{tabular}
\end{center}
\label{SWF-table}
\end{table}

\newpage

\subsubsection{Example}

An example of a \texttt{Par\_file\_faults} file with different shapes and parameters is given below. It contains a section with SPECFEM3D-compatible definitions for a fault-local stress field.

\begin{lstlisting}[mathescape]
@! ----------------- SPECFEM3D-compatible part -----------------@
&INIT_STRESS S1=0.0, S2=0.0, S3=0.0, n1=0, n2=1, n3=1 /

@! ------ along-dip ------@
&DIST2D shapeval='x-cylinder', val=-80e6, xc=0, yc=0, zc=-15e3, lz=3e3, r=2.0e3 /

@! ----- fault-normal -----@
@! Stress: $\textcolor{green}{1020 \cdot |z|}$ @
&DIST2D shapeval='rectangle-taper', val = -20.4e6, valh = 0, xc =0, yc=-3.75e3, zc=-10e3, lx=32.0e3, ly=9.0e3, lz=20.0e3 /

@! ------------------- SeisSol-exclusive part -------------------@
&DIST2D param='localstress', dir='dip', shapeval='square', val = -100e6, xc=0, yc=0, zc=-5e3, l=2.0e3 /

&DIST2D param='globalstress', dir='yz', shapeval='circle', val=60e6, xc=0, yc=0, zc=-10e3, r=3.0e3 /

&DIST2D param='cohesion', shapeval='ellipse', val=40e6, xc=10e3, yc=0, zc=-10e3, lx=4e3, ly=1e3, lz=2e3 /
\end{lstlisting}

\newpage

\section{Source Terms}
\label{sec-block-src}

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{SourceType}.
If changing a value requires setting a new
parameter it is indicated in green after the dashed line (if changing a value results in setting a new
parameter in a different namelist, this namelist is written in red):\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{SourceType}.
         Changing the parameter from the default value often results in setting additional parameters in the corresponding namelist (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist, the namelist is written in red. The blue words represent
         links for navigating to a detailed description of the parameter.}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
Type & 0 & integer & Source Type\\
\hdashline
\uline{Type} = 1 & & &\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{Source110} & & &\\
\textcolor{green}{U0} &  & real & \\
\textcolor{green}{l1} &  & real & \\
\hdashline
% \uline{Type} = 15 & & &\\
% \textcolor{green}{nDirac} & & integer & \# Dirac Sources\\
% \textcolor{red}{New namelist:} & & &\\
% \textcolor{red}{Source15} & & &\\
% \textcolor{green}{SpacePositionx} &  & real & x-line of Spaceposition-matrix. \\
% \textcolor{green}{SpacePositiony} &  & real & y-line of Spaceposition-matrix.\\
% \textcolor{green}{SpacePositionz} &  & real & z-line of Spaceposition-matrix.\\
% \textcolor{green}{TimePosition} &  & real & \\
% \textcolor{green}{Intensity} &  & real & \\
% \textcolor{green}{EqnNr} &  & real & \\
% \hdashline
\uline{Type} = \hyperlink{src16}{\textcolor{blue}{16}}, \hyperlink{src18}{\textcolor{blue}{18}} & & &\\
\textcolor{green}{nRicker} & & integer & \# Ricker Sources in case 16. \# Gaussian Sources in case 18.\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{Source1618} & & &\\
\textcolor{green}{SpacePositionx} &  & real & x-line of Spaceposition-matrix.  \\
\textcolor{green}{SpacePositiony} &  & real & y-line of Spaceposition-matrix. \\
\textcolor{green}{SpacePositionz} &  & real & z-line of Spaceposition-matrix. \\
\textcolor{green}{Delay} &  & real & \\
\textcolor{green}{a1} &  & real & \\
\textcolor{green}{f} &  & real & \\
\textcolor{green}{EqnNr} &  & real & \\
\hline
% \end{tabular}
% \end{center}
% \label{src1-table}
% \end{table}
%
% \begin{table}[H]
% \caption{Continue table of table \ref{src1-table}}
% \begin{center}
% \begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
% \hline
% Parameter & Default Value & Type & Short Description \\
% \hline
% \hline
% \uline{Type} = 17 & & &\\
% \textcolor{red}{New namelist:} & & &\\
% \textcolor{red}{Source17} & & &\\
% \textcolor{green}{U0} &  & real & \\
% \textcolor{green}{l1} &  & real & \\
% \textcolor{green}{l2} &  & real & \\
% \textcolor{green}{T} &  & real & \\
% \hdashline
% \uline{Type} = \hyperlink{src19}{\textcolor{blue}{19}} & & &\\
% \textcolor{green}{nPulseSource} & & integer & \\
% \textcolor{red}{New namelist:} & & &\\
% \textcolor{red}{Source19} & & &\\
% \textcolor{green}{SpacePositionx} &  & real & x-line of Spaceposition-matrix.\\
% \textcolor{green}{SpacePositiony} &  & real & y-line of Spaceposition-matrix.\\
% \textcolor{green}{SpacePositionz} &  & real & z-line of Spaceposition-matrix.\\
% \textcolor{green}{t0} &  &  & \\
% \textcolor{green}{Width} &  &  & \\
% \textcolor{green}{A0} &  &  & \\
% \hdashline
\uline{Type} = \hyperlink{src20}{\textcolor{blue}{20}}, 30, \hyperlink{src50}{\textcolor{blue}{50}} & & &\\
\textcolor{green}{FileName} & & character & Read parameters from file.\\
\hline
\end{tabular}
\end{center}
\label{src2-table}
\end{table}


\newpage

\subsection{Source\%Type 16 = RICKER}
\hypertarget{src16}{Like} source type 18 but other wavelet!.
Dirac sources in space and Ricker wavelet in time.

\begin{equation}
   g''(\tau) = a_1\left(1/2 + a_2 \tau^2 \right) \cdot \exp(a_2 \tau^2)
\end{equation}


\subsection{Source\%Type 18 = GAUSS}
\hypertarget{src18}{Dirac sources} in space and Gaussian wavelet in time.
Single point source described by

\begin{equation}
   g(\tau) = a_1 \cdot \exp(-\tau/f^2)
\end{equation}

% !!!Attention!!! the following part is copied from the user manual. Don't know
% if the upper function still holds the descriptions below:
% An interesting characteristic of this function is that the integral of the
% equation above over time interval $t \in [-\infty , \infty]$ is $\tau A_0$. From
% this relation we can define $A_0$ considering
%
% \begin{equation}
%    \tau A_0 = \int S(t) \, dt = \frac{M_0}{\mu A}\,
%    \label{eq::Source19_2}
% \end{equation}
% %
% with $M_0 $ in [Nm] the scalar seismic moment, $\mu$ in [Pa] the shear module
% and $A=1$ in [$m^2$] the area of the source. Now, for a explosive source ($xx$
% and $yy$ stresses) at $(x,y)=(-5530.0,-10420.0)$, a given scalar seismic moment
% $M_0=7.53\time 10^{18}$ [Nm], a shear module $\mu = 2.2 \times 10^9$ [Pa] and
% $\tau = 0.5$ [s] with get $A_0 = 6.8\bar{45} \times 10^9$ [m/s]. For using the source type, center
% the function at $t=t_0=0.5$ [s].


% \begin{lstlisting}
%    18                           ! source type
%    2                            ! Number of source
%    -5530.0 -10420.0   0.        ! Source position
%    1.5                          ! Time central peak
%    0.5                          ! Width of the pulse
%    6.85e9                       ! Amplitude
%    1                            ! Affected variable
%    -5530.0 -10420.0   0.        ! Source position
%    1.5                          ! Time central peak
%    0.5                          ! Width of the pulse
%    6.85e9                       ! Amplitude
%    2                            ! Affected variable
% \end{lstlisting}

% \subsection{SOURCE\%Type = 19}
%
% \hypertarget{src19}{Single} point source describes by
% \begin{equation}
% 	s(t) = \frac{A_0}{exp(\pi (t-t_0)^2 / \tau^2)} \,.
% 	\label{eq:Source19_1}
% \end{equation}
%
% An interesting characteristic of this function is that the integral of (\ref{eq:Source19_1}) over time interval
% $t \in [-\infty , \infty]$ is $\tau A_0$. From this relation
% we can define $A_0$  considering
%
% \begin{equation}
% 	\tau A_0 = \int S(t) \, dt = \frac{M_0}{\mu A}\,
% 	\label{eq::Source19_2}
% \end{equation}
% %
% with $M_0 $ in [Nm] the scalar seismic moment, $\mu$ in [Pa] the shear module and $A=1$ in [$m^2$] the area of the source.
% Now, for a explosive source ($xx$ and $yy$ stresses)
%  at $(x,y)=(-5530.0,-10420.0)$, a given scalar seismic moment $M_0=7.53\time 10^{18}$ [Nm],
% a shear module $\mu = 2.2 \times 10^9$ [Pa] and $\tau = 0.5$ [s] with get
% $A_0 = 6.8\bar{45} \times 10^9$ [m/s].For using the source type, center the function at $t=t_0=0.5$ [s].

\subsection{SOURCE\%Type = 20}
\hypertarget{src20}{A single point} force is an important source type for the computation of Green's functions.
Computing the solution for the three different point forces in x-, y- and z-direction allows us to synthesize seismograms
that would result from an arbitrary moment tensor afterwards.
Each single force can have an individual source time function for the slip.
As an example, Tab.~\ref{SF-source-file} shows the buildup of such a source file.\\
However, the synthesized seismograms will result in an equivalent moment tensor source which uses the slip rate as source
time function.
If the slip rate function is normalized to $1$, the single force seismograms also have to be scaled
by multiplying with the corresponding scalar seismic moment of the moment tensor source and the shear modulus, i.e.
\begin{equation}
s(t)_{Moment Tensor} = s(t)_{Single Force} \cdot M_0 \cdot \mu\,.
\end{equation}

\begin{table}
\caption{Structure of Single Force source file}
\begin{center}
\begin{tabular}{l}
\hline
Number of Sources\\
1\\
Single Force on Variable Nr.\\
7\\
x \hspace{4mm} y \hspace{4mm} z \hspace{4mm} \\
10. \hspace{0.5mm} 0. \hspace{2mm} 20.\\
Source Time Functions\\
0.001\hspace{6mm} 3\\
Samples\\
0.\\
1.3\\
0.\\
\hline
\end{tabular}
\end{center}
\label{SF-source-file}
\end{table}

Furthermore, in combination with the single force source, it is useful to use a specific output option given in
Section~\ref{sec-block-out} and denoted as {\em Moment Tensor Contribution}.

\subsection{SOURCE\%Type = 50}
\noindent
\hypertarget{src50}{A very important} source type is given by the SOURCE\%Type=50.
It offers extended finite sources with a double couple moment tensor with individual slip rate history for each subfault.
All information is comprised in a separate file, which we usually call {\tt FSRM-filename.dat} as it is a Finite Source Rupture Model.

\noindent
As an example, Tab.~\ref{FSRM-source-file} shows the buildup of such a source file.
Lines 2 - 4 include the components of the seismic moment tensor.
In this case we have chosen 2 Pa for the $xz-$ component.

\begin{table}
\caption{Structure of Double Couple source file}
\begin{center}
\begin{tabular}{l}
\hline
Seismic Moment Tensor\\
0. \hspace{4mm} 0. \hspace{4mm} 2.\\
0. \hspace{4mm} 0. \hspace{4mm} 0. \\
2. \hspace{4mm} 0. \hspace{4mm} 0. \\
Number of Subfaults\\
2\\
x \hspace{4mm} y \hspace{4mm} z \hspace{4mm} strike \hspace{4mm} dip \hspace{4mm} rake \hspace{4mm} area$\cdot\mu$ \hspace{4mm} onset time\\
30. \hspace{0.5mm} 0. \hspace{2mm} 90.\hspace{6mm} 0. \hspace{7mm} 1.57 \hspace{7mm} 0. \hspace{7mm} 1.\hspace{14mm} 0.123\\
12. \hspace{0.5mm} 8. \hspace{2mm} 10.\hspace{6mm} 0. \hspace{7mm} 1.57 \hspace{7mm} 0. \hspace{7mm} 1.\hspace{14mm} 0.234\\
Source Time Functions\\
0.001\hspace{6mm} 3\\
Samples\\
0.\\
1.3\\
0.\\
0.\\
1.6\\
0.\\
\hline
\end{tabular}
\end{center}
\label{FSRM-source-file}
\end{table}

The number of subfaults is given in line 6. In the example of Table~\ref{FSRM-source-file} line 8 and 9
(the number of lines has to coincide with the number of subfaults!) give information about the location
and the properties of the rupture.
Angles of strike, dip, and rake have to be specified in rad.
Afterwards the shape of the impulse time function itself is specified by the sampling interval (e.g. 0.001 sec)
and the number of samples (e.g. 3).
Then, the 3 values of these samples are given line by line for subfault 1.
Then the values of subfault 2 are listed and so on, such that there are $n =$ number-of-subfaults $\times$ number-of-samples lines.

\newpage

\section{Sponge Layer}
\label{sec-block-spg}


The sponge consists of one (or more) cohesive layer(s) around the computational domain.
In contrast to common absorbing boundary conditions it uses not just the outermost boundary of the grid
but has a thickness of several elements.
As already indicated, the sponge layer is a technical construct which absorbs the outgoing waves
in order to minimize unwanted reflections due to the artificial boundaries.\\
The current parameter file allows 3 different values for the type of sponge:
Option 0 means that no sponge is used.
Option 1 activates one (or more) sponge layer(s), in which the outgoing waves are attenuated uniformly.
The dumping factor depends on the distance to the outermost boundary, where the waves should finally\index{} be absorbed completely.\\
Several studies of the last few years showed that these sponge layers do not work satisfying.
Reflections into the computational domain are still observed.
Therefore, another type of layer (option 2) was introduced.
The perfectly matched layer (PML) differentiates between the spatial components of the outgoing waves and therefore improves the
nullification of reflections.
As in our case the PML is still under construction, option 1 is kept running.\\
\newpage

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{SpongeLayer}.
If changing a value requires setting a new
parameter it is indicated in green after the dashed line (if changing a value results in setting a new
parameter in a different namelist, this namelist is written in red):\\


\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{SpongeLayer}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist,
         the namelist is written in red.}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
enabled & 0 & 0, 1, 3 & Sponge on/off or usage of PML.\\
\hdashline
\uline{enabled} = 1 & & &\\
\textcolor{green}{DGSpongeTol} &  & real & \\
\textcolor{green}{intDummy} &  & integer & \\
\textcolor{green}{nDGSponge} &  & integer & \# Sponge boundaries.\\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{Sponges} & & &\\
\textcolor{green}{SpongeDelta} &  & real & \\
\textcolor{green}{SpongePower} &  & real & \\
\textcolor{green}{SigmaMax} &  & real & \\
\hdashline
\uline{enabled} = 3 & & &\\
\textcolor{green}{PMLDelta} & & real &\\
\textcolor{green}{Refl\_Coeff} &  & real & \\
\textcolor{green}{PMLPrefactor} &  & real & \\
\textcolor{green}{PMLFrequency} &  & real & \\
\hline
\end{tabular}
\end{center}
\label{sponge-table}
\end{table}


\newpage

\section{Mesh}
\label{sec-block-msh}

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{MeshNml}.\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{MeshNml}.}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
 MeshFile & LOH1 & character & Name of mesh file.\\
mesh generator & Gambit3D & character & Meshgenerator. \\
displacement & (0.0, 0.0, 0.0) & real & \\
ScalingMatrixX & (1.0, 0.0., 0.0) & real & x-component of scaling matrix. \\
ScalingMatrixY & (0.0, 1.0., 0.0) & real & y-component of scaling matrix. \\
ScalingMatrixZ & (0.0, 0.0., 1.0) & real & z-component of scaling matrix. \\
periodic & 0 & 0/1 & Periodic boundary conditions off/on.\\
periodic\_direction & (0, 0, 0) & 0/1 & Vector with 3 switches, indicating if periodic boundary exists in x-, y- and/or z-direction.\\
\hline
\end{tabular}
\end{center}
\label{mesh-table}
\end{table}

\newpage

\section{Discretization}
\label{sec-block-dis}

This block collects the information on the polynomial approximation used for the numerical simulation
as well as the particularities of the solver chosen. \\
%The first parameter is a switch on whether to use or not the \textit{fine output} output type.
%This output type will be sampled under the same circumstances as other assigned
%snapshot output later in block~\ref{sec-block-dis}.
%The main difference with respect to the standard snapshot output is that it will output the maximum spatial information
%available, that is, all the degrees of freedom being used by the code.
%The structure and content of the fine output files will be treated in a Section of its own.\\
The SeisSol variants are, at the present moment, either 1 or 3 (option 2 is disabled).
Option 1 means a global time stepping (GTS) computation and option 3 a local time stepping (LTS) computation.
The difference between both is that GTS updates all the cells from time step to time step at once.
Therefore the minimum stable time increment has to be used for all cells.
LTS computations, on the other hand, iterate the updates for each cell independently,
minimizing the total number of operations required.
In general, for very uneven meshes, LTS should be faster.
Further information can be found in \cite{DumbserKaeserToro07}.
% Still is possible to use option 4, a so-called
% \textit{reconstruction} ADER-DG scheme. The concept is to mix in-cell resolution from DG schemes with stencil
% reconstruction from Finite Volumes. In an extreme case of using
% just order 1 approximation inside each element, a pure high-order FV scheme will be produced.
% Details on the usage of this option 4 will be skipped in the following although
% some results computed with it can be found in \cite{DumbserKaeserdelaPuente06}.\\
The time integration variant includes two possible types.
First is the standard ADER based upon a Cauchy-Kovalewski procedure (value 0), as used in most practical problems and
described in \cite{KaeserDumbser06} and \cite{DumbserKaeser06}.
The other type is the Space-Time Discontinuous ADER time integration (value 1) which is just as accurate but
more robust for solving stiff problems (see \cite{PuenteDumbserKaeserIgel07}). \\
For LTS simulation, we must specify what we call a computing \textit{cycle}.
Using a value 1 means that one cycle is fulfilled each time we loop over all elements,
independently on whether we update their values or not.
Using a value 2 means that one cycle is fulfilled once each and every
element has been at least updated once.\\
Next, we can adapt the order of the scheme $\O$.
This value is linked to the polyomial degree of the basis functions $p$ by $\O=p-1$.
An order of accuracy must be assigned, ranging from 1 to 10 (in 2D) or from 1 to 7 (in 3D).\\
Finally, the Courant number C can be adjusted for stability reasons.
This number is the fraction of the CFL stability limit, which for our DG schemes is
\begin{equation}
\label{cfl}
\Delta t\leq C \frac{1}{2p+1}\frac{\Delta x}{\alpha}\,,
\end{equation}
being $\alpha$ the maximum wave velocity allowed, usually the P-wave velocity,
$\Delta x$ a measure of the size of the element (3D tetrahedral elements: in-sphere diameter)
and $p$ is the polynomial degree of the approximation.
Notice, that equation~\eqref{cfl} must be fulfilled by all elements,
hence the advantage of the above mentioned LTS schemes over GTS schemes in highly uneven meshes.
The value of $C$ is bound by the upper value $C=1$, although for ADER-DG the maximum is $C=0.7$.
Often a safer value of $C=0.5$ is used.\\
The last important parameter is the fixed timestep, a value $\Delta t$ at which we want to impose the scheme to iterate.
In general, we do not want to impose such number, but let the code choose the optimal following equation~\eqref{cfl}.
Then it is recommended to use a very large value here, much larger that the time scale of the problem to be solved.\\

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Discretization}.
If changing a value requires setting a new parameter it is indicated in green after the dashed line:\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Discretization}.
         Changing the parameter from the default value often results in setting additional parameters in the corresponding namelist (indicated in green). }
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
CFL & 0.5 & real & \\
FixTimeStep & 5000 & integer & \\
%DGFineOut1D & 0 & 0/1 & Switches Fine Output on/off.\\
CKMethod & 0 & 0/1 & 0: standard CK procedure; 1: Using space-time DG approach.\\
FluxMethod & 0 & 0/1 & 0: Gudunov flux; 1: Rusanov flux.\\
DGMethod & 0 & integer & Possiblity to choose time stepping.\\
\hdashline
\uline{DGMethod} = 1 & & & Global time stepping\\
\textcolor{green}{Order} & & integer & \\
\textcolor{green}{nPolyMap} & 0 & integer & \\
\textcolor{green}{Material} & 0 & integer & Material basis functions degree.\\
\hdashline
\uline{DGMethod} = 3 & & & Local time stepping\\
\textcolor{green}{Order} & & integer & \\
\textcolor{green}{nPolyMap} & 0 & integer & \\
\textcolor{green}{Material} & 0 & integer & Material basis functions degree.\\
\textcolor{green}{IterationCriterion} & & 1/2 & 1: Iteration is defined as one cycle;
2: Iteration is defined by update of all elements.\\
% \hdashline
% \uline{DGMethod} = 4 & & & Godunov flux and global time stepping. \\
% \textcolor{green}{nPoly} & & integer & \\
% \textcolor{green}{nPolyRec} & & integer & .\\
\hline
\end{tabular}
\end{center}
\label{disc-table}
\end{table}

\newpage

\section{Output}
\label{sec-block-out}

This block includes all the information on the outputting of data from the SeisSol simulations.
The data output is about the two types: \textit{snapshot} and \textit{receiver} output.
The snapshot output is volumetric information on the variables at some particular instant of the simulation.
The receiver output is a time continuous recording of the variables at a particular point in space.
In general, the user has to specify the output variables as well as when and where these variables are going to be recorded.\\

\noindent
A generic filename provided by the user will be created of different character strings to produce unique files for the various outputs.
The structure and content of these files will be treated in a Section of its own.
%A third type of output called ``fine output'' can also be created, as shown in Section~\ref{sec-block-dis}.

\noindent
When the rotational output option $1$ is selected, the code will output rotation rates around the axes $x$, $y$ and $z$.
Then, the user is required to specify which of this 3 rotation rates he wants to output with 0-1 switches.

\noindent
When the moment tensor contribution output option $2$ is selected, the code will output the six further quantities, which are
the moment tensor contributions of a single force in x-, y- or z-direction, depending on the Single Force Variable Nr. specified
in Source\&Type $= 20$. For further information see~\cite{GravesWald01}.

\noindent
The number of variables (stresses and velocities) that can be outputted depends on the equations being solved and the dimension.
A 0-1 switch has to be specified for each variable, meaning 1 that the user wants to output that particular variable
and 0 that he does not want. The following variables' switches have to be specified:\\
2D, 5 switches: $\sigma_{xx}$, $\sigma_{yy}$, $\sigma_{xy}$, $u$, $v$.\\
3D, 9 switches: $\sigma_{xx}$, $\sigma_{yy}$, $\sigma_{zz}$, $\sigma_{xy}$, $\sigma_{yz}$, $\sigma_{xz}$, $u$, $v$, $w$.\\

\noindent
For the poroelastic case, one additional parameter has to be provided specifying the output switches for the fluid variables
(pressure and fluid velocities) as follows:\\
2D, 3 switches: $p$, $u_f$, $v_f$.\\
3D, 4 switches: $p$, $u_f$, $v_f$, $w_f$.\\

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Output}.
If changing a value requires setting a new parameter it is indicated in green after the dashed line:\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Output}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
OutputFile & data & character & Root name of output file. \\
iOutputMaskMaterial & (0, 0, 0, 0, 0, 0, 0, 0, 0) & integer & \\
iOutputMaskMaterial & (0, 0, 0) & integer & \\
Rotation & 0 & integer & \\
Format = 1,5,10 & 1 & integer & 1 Tecplot, 5 HDF5/XDMF, 10 3D output off \\
printIntervalCriterion &  & integer & Criterion about time printed time step.\\
\hdashline
\uline{printIntervalCriterion} = 1,3 & & & \\
\textcolor{green}{Interval} & & real & \\
\hdashline
\uline{printIntervalCriterion} = 2,4 & & & \\
\textcolor{green}{TimeInterval} & & real & \\
\hline
pickdt & 0.1 & real & \\
pickDtType & 1 & integer & \\
pickDtType & 1 & integer & \\
nRecordPoints & & integer & \\
RFileName & RecordPoints & character & \\
PGMFlag & 0 & 0/1 & Peak ground motion output at given receivers.\\
\hdashline
\uline{PGMFlag} = 1 & & & Number of receivers for peak ground motion output, followed by their 3D coordinates.\\
\textcolor{green}{PGMFile} & & character & \\
\hline
FaultOutputFlag & 0 & 0/1 & Switch fault output off/on.\\
\hline
checkPointInterval & 0 & integer & Interval for writing checkpoints (0 = disable checkpoints) \\
checkPointFile & & character & Checkpoint filename \\
\hline
\end{tabular}
\end{center}
\label{output-table}
\end{table}



\subsection{Snapshot Output}
\label{sec-block-snap}

For the snapshot output, the material parameters to be outputted have to be defined by switches
in a similar way as the variables just shown in the last paragraphs.
The material values depend on the rheology type chosen.
They are described in the Section~\ref{sec-matfile} in the proper order.
All the material parameters can be outputted with the sole exception of the $\Q$ values
and the $\vec n$, $\vec s$ and $\vec t$ entries.
The switches have to be typed in order and not more than 11 switches per line.
If the number of material parameters is larger than 11, a second line will have to be added.
In case more than 22 parameters are required, a third line is needed.

\noindent
SeisSol currently only accepts 2 output format for snapshots
and requires TECPLOT or paraview (use postprocessing conversion script tecp2vtk!) to be visualized:\\

\noindent
1: TECPLOT format\\
5: HDF5/XDMF parallel binary output for paraview\\

\noindent
There are 3 possible criteria: Output every given number of timesteps
(option $1$), every given multiples of a specified time (option $2$)
or when any of both criteria just mentioned are fulfilled (option $3$). \\

\subsection{Receiver Output}
\label{sec-block-rec}

For the receiver output, three parameters are required:
the time sampling rate, the number of receiver stations and their locations.
The code will automatically interpolate the variables' values at the desired times.

\newpage

\section{Abort Criteria}
\label{sec-block-abo}

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{AbortCriteria}.
If changing a value requires setting a new parameter it is indicated in green after the dashed line:\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{AbortCriteria}.}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
EndTime & 15.0 & real &  \\
MaxIteration & 10000000 & integer &  \\
WallTime\_h & 1e20 & real &  \\
Delay\_h & 0.0 & real &  \\
\hline
\end{tabular}
\end{center}
\label{abort-table}
\end{table}

\newpage



\section{Analysis of Data}
\label{sec-block-ana}

This option is only important for convergence tests, to analyze the numerical error with respect to
an analytical solution and to output directly the errors in the $L_1$, $L_2$, or $L_\infty$-norm on
screen or in the log files.\\
In all other cases (e.g. simulations for applications), which are not convergence studies this option
has to be $0$.

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Analysis}.
If changing a value requires setting a new
parameter it is indicated in green after the dashed line (if changing a value results in setting a new
parameter in a different namelist, this namelist is written in red):\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Analysis}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).
         If changing the default value requires an additional setting of a parameter in a different namelist,
         the namelist is written in red.}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
typ & 0 & integer & Choice of analysis type. \\
variables & (0, 0, 0, 0, 0, 0, 0, 0, 0) & 0/1 & Analysis variables.\\
\hdashline
\uline{typ} = 14 & & & \\
\textcolor{green}{setvar} & & integer & \\
\textcolor{green}{EigenVecValName} & & character & \\
\textcolor{red}{New namelist:} & & &\\
\textcolor{red}{AnalysisFields} & & &\\
\textcolor{green}{varfield} & & real & \\
\textcolor{green}{ampfield} & & real & \\
\hline
\end{tabular}
\end{center}
\label{analysis-table}
\end{table}

\newpage

\section{Debugging Modus}
\label{sec-block-dbg}

At the moment, to be set to $0$ as other options are not possible.
This option is a default for debugging purposes.

In the following, we list all parameters with their possible and default values to be set in the namelist \textbf{Debugging}.
If changing a value requires setting a new
parameter it is indicated in green after the dashed line:\\

\begin{table}[H]
\caption{Parameters and their default values as well as type for the namelist \textbf{Debugging}.
         Changing the parameter from the default value often results in setting additional parameters
         in the corresponding namelist (indicated in green).}
\begin{center}
\begin{tabular}{|p{4cm}|p{2.7cm}|p{2cm}|p{4cm}|}
\hline
Parameter & Default Value & Type & Short Description \\
\hline
\hline
debug\_flag & 0 & 0/1 & Debug mode off/on. \\
\hdashline
\uline{debug\_flag} = 1 & & & \\
\textcolor{green}{level} & 0 & integer & \\
\hline
\end{tabular}
\end{center}
\label{debug-table}
\end{table}

\newpage

\section{DISCLAIMER}

Note that the here documented features are not all compatible with each other.
Moreover, no guarantee is given that some features might be outdated or their functionality changed
as the SeisSol development is always in progress.
We highly recommend to test thoroughly each functionality for your individual problem.

\noindent Furthermore, our general DISCLAIMER holds:

\noindent THIS SOFTWARE OR DOCUMENTATION IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% REFERENCES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{99}
\bibitem{Andrews2005}D.J. Andrews, 2005. \textit{Rupture dynamics with energy loss outside the slip zone}, Journal of Geophysical Research.
\bibitem{PuenteDumbserKaeserIgel07}
  de la Puente, J., Dumbser,M., K\"aser, M. \& Igel, H.: Discontinuous Galerkin Methods for Wave Propagation in Poroelastic Media, \textit{Geophysics}. 73(5), T77-T97, 2008.
\bibitem{PuenteKaeserDumbserIgel07}
  de la Puente, J., K\"aser, M., Dumbser, M. \& Igel, H., 2007. An Arbitrary High Order Discontinuous
  Galerkin Method for Elastic Waves on Unstructured Meshes - IV. Anisotropy.
  \textit{Geophys.~J.~Int.} \textbf{169 (3)}, 1210-1228.
\bibitem{DumbserKaeser06}
  Dumbser, M. \& K\"aser, M., 2006. An Arbitrary High Order Discontinuous Galerkin Method for
  Elastic Waves on Unstructured Meshes - II. The Three-Dimensional Isotropic Case.
  \textit{Geophys.~J.~Int.} \textbf{167 (1)}, 319-336.
\bibitem{DumbserKaeserToro07}
  Dumbser, M., K\"aser, M. \& Toro, E.F., 2007. An arbitrary high-order Discontinuous Galerkin method for elastic
  waves on unstructured meshes  V. Local time stepping and p-adaptivity.
  \textit{Geophys.~J.~Int.}
\bibitem{DumbserKaeserdelaPuente06}
  Dumbser, M., K\"aser, M. \& de la Puente, J., 2007. Arbitrary High Order Finite Volume Schemes for Seismic Wave Propagation on
  Unstructured Meshes in 2D and 3D,
  \textit{Geophys.~J.~Int.}
\bibitem{GravesWald01}
  Graves, W.R. \& Wald, D.J., 2001. Resolution analysis of finite fault source inversion using one- and three-dimensional Green's functions    1. Strong motions,
  \textit{J.~Geophys.Res.}, \textbf{106 (B5)}, 8745-8766.
\bibitem{KaeserDumbser06}
  K\"aser, M. \& Dumbser, M., 2006. An Arbitrary High Order Discontinuous Galerkin Method for
  Elastic Waves on Unstructured Meshes - I. The Two-Dimensional Isotropic Case with External Source Terms.
  \textit{Geophys.~J.~Int.}, \textbf{166 (2)}, 855-877.
\bibitem{KaeserDumbserPuente07}
  K\"aser, M., Dumbser, M., de la Puente, J. \& Igel, H., 2007. An Arbitrary High Order Discontinuous
  Galerkin Method for Elastic Waves on Unstructured Meshes - III. Viscoelastic Attenuation.
  \textit{Geophys.~J.~Int.}, \textbf{168 (1)}, 224-242.
\bibitem{Pelties12}
  Pelties, C., de~la Puente, P., Ampuero, J.-P., Brietzke, G.~B., and K\"aser,
  M.: Three-dimensional dynamic rupture simulation with a high-order
  discontinuous {G}alerkin method on unstructured tetrahedral meshes,
  J.~Geophys.~Res., 117, B02309,
  \url{http://dx.doi.org/10.1029/2011JB008857}, 2012.
\bibitem{Pelties14}
  Pelties, C., Gabriel, A.-A., and  Ampuero, J.-P.:
  Verification of an ADER-DG method for complex dynamic rupture problems,
  Geosci.~Model~Dev., 7, 847-866, 2014.
\end{thebibliography}

\end{document}
